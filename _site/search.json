[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "אודותיי",
    "section": "",
    "text": "היי!\nאני עמית, דאטה אנליסט בחברת פיוניר ובכללי בתחום הדאטה כבר כמה שנים. את האתרון הזה החלטתי לפתוח כשהבנתי שאני אוהב לשתף דברים מגניבים שיצא לי לפתור בעבודה, אבל הבנתי שאין לי יותר מדי עם מי בצורה קלה. ולכן במקום לנסות למצוא אנשים ספציפיים שאחפור להם, החלטתי להנגיש את זה לכולם. חוץ מזה, התחשק לי לפרסם קצת תוכן על דאטה בעברית, אז עוד סיבה לפתיחה שלו.\nזהו, מוזמנים להגיד שלום/הערות/בקשות באחד מהקישורים מטה =&gt;"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "מקבץ תרגילים ממקרים שהיו",
    "section": "",
    "text": "הירשמו וקבלו עידכונים על תרגילים חדשים\n        \n            \n            \n        \n    \n        \n            \n                \n                \n            \n        \n    \n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n\n\n\nיישום נוסחאות בקוד\n\n\n\n\n\n\n\nבסיסי\n\n\n\n\nתרגום נוסחה סטטיסטית לקוד SQL\n\n\n\n\n\n\nDec 12, 2023\n\n\n\n\n\n\n  \n\n\n\n\nחילוץ טקסט\n\n\n\n\n\n\n\nבסיסי\n\n\n\n\nחילוץ חלקי טקסט מתוך לוגים\n\n\n\n\n\n\nNov 28, 2023\n\n\n\n\n\n\n  \n\n\n\n\nערכים לפני ואחרי נקודת זמן\n\n\n\n\n\n\n\nבסיסי\n\n\n\n\nהחזרת ציון ‘סכנת עזיבה’ לפני התשלום הראשון ומיד לאחריו\n\n\n\n\n\n\nNov 9, 2023\n\n\n\n\n\n\n  \n\n\n\n\nדירוג שורות בלי פונקצית חלון\n\n\n\n\n\n\n\nמתקדם\n\n\n\n\nדירוג שורות בתוך קבוצה בלי שימוש בפונקצית חלון\n\n\n\n\n\n\nOct 3, 2023\n\n\n\n\n\n\n  \n\n\n\n\nאפיון תשלומים זהים או שונים\n\n\n\n\n\n\n\nבסיסי\n\n\n\n\nקיטלוג לקוחות עם סטטוס תשלומים זהה או לפחות אחד שונה\n\n\n\n\n\n\nSep 19, 2023\n\n\n\n\n\n\n  \n\n\n\n\nזיהוי רצפים בהתחברות\n\n\n\n\n\n\n\nמתקדם\n\n\n\n\nתרגול זיהוי פעולות רצופות\n\n\n\n\n\n\nSep 5, 2023\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "questions/1-consecutive-actions/index.html",
    "href": "questions/1-consecutive-actions/index.html",
    "title": "זיהוי רצפים בהתחברות",
    "section": "",
    "text": "ברוכים הבאים לתרגיל הראשון בניוזלטר!"
  },
  {
    "objectID": "questions/1-consecutive-actions/index.html#הדאטה",
    "href": "questions/1-consecutive-actions/index.html#הדאטה",
    "title": "זיהוי רצפים בהתחברות",
    "section": "הדאטה",
    "text": "הדאטה\nהתרגיל יורכב משתי שאלות. בטבלה למטה ניתן לראות ניסיונות התחברות של יוזרים (success / fail) בנקודות זמן שונות.\n\nSELECT TOP 10 * FROM LOGINS;\n\n\nDisplaying records 1 - 10\n\n\nuser_id\nlogin_date\nlogin\n\n\n\n\n3\n2022-08-12\nsuccess\n\n\n4\n2022-08-26\nsuccess\n\n\n5\n2022-07-17\nsuccess\n\n\n5\n2022-11-02\nsuccess\n\n\n2\n2023-06-07\nsuccess\n\n\n1\n2023-05-07\nsuccess\n\n\n5\n2023-04-28\nfail\n\n\n3\n2023-04-26\nsuccess\n\n\n2\n2023-02-05\nsuccess\n\n\n5\n2022-12-22\nfail"
  },
  {
    "objectID": "questions/1-consecutive-actions/index.html#שאלות",
    "href": "questions/1-consecutive-actions/index.html#שאלות",
    "title": "זיהוי רצפים בהתחברות",
    "section": "שאלות",
    "text": "שאלות\n\nשאלה 1\nעבור כל יוזר החזירו את רצף הצלחות התחברות הגדול ביותר.\nלדוג’, עבור יוזר 2 עם ההתחברויות הבאות:\n\n\n\n\n\n\n\nנחזיר את הרשומה הבאה (שכן ניתן לראות למעלה שיש לו רצף של 6 הצלחות התחברות כמספר הגבוה ביותר):\n\n\n\n1 records\n\n\nuser_id\nmost_consecutive_logins\n\n\n\n\n2\n6\n\n\n\n\n\n\n\nשאלה 2\nברגע שיוזרים נכשלים בהתחברות שלוש פעמים באופן רצוף החשבון שלהם ננעל. עבור כל יוזר עם שלוש כשלונות התחברות או יותר, החזירו את התאריך (login_date) בו הוא קיבל לראשונה את הכשלון השלישי באופן רצוף.\nלדוג’, עבור יוזר 1:\n\nSELECT TOP 7 * FROM LOGINS\nwhere user_id = 1\norder by login_date;\n\n\n7 records\n\n\nuser_id\nlogin_date\nlogin\n\n\n\n\n1\n2022-07-09\nfail\n\n\n1\n2022-07-15\nfail\n\n\n1\n2022-07-20\nsuccess\n\n\n1\n2022-08-12\nfail\n\n\n1\n2022-08-15\nfail\n\n\n1\n2022-08-22\nfail\n\n\n1\n2022-09-13\nsuccess\n\n\n\n\n\nניתן לראות שבניסיון התחברות ה-4, 5, ו-6 הוא נכשל לראשונה לפחות שלוש פעמים. לכן נחזיר עבורו את הערך 2022-08-22.\n\n\n\n1 records\n\n\nuser_id\nFIRST_3rd_failed_login\n\n\n\n\n1\n2022-08-22"
  },
  {
    "objectID": "questions/1-consecutive-actions/index.html#יצירת-הטבלה",
    "href": "questions/1-consecutive-actions/index.html#יצירת-הטבלה",
    "title": "זיהוי רצפים בהתחברות",
    "section": "יצירת הטבלה",
    "text": "יצירת הטבלה\nמוזמנים להשתמש בקוד הבא ליצירת טבלה (יש סימן להעתקה בצד ימין למעלה של המלבן כשמעבירים את העכבר מעליו):\n\n\n--drop table if exists logins; /* Drop with caution */\n\ncreate table logins (\n    user_id INT,\n    login_date DATE,\n    login VARCHAR(50)\n);\ninsert into logins (user_id, login_date, login) values (3, '8/12/2022', 'success');\ninsert into logins (user_id, login_date, login) values (4, '8/26/2022', 'success');\ninsert into logins (user_id, login_date, login) values (5, '7/17/2022', 'success');\ninsert into logins (user_id, login_date, login) values (5, '11/2/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '6/7/2023', 'success');\ninsert into logins (user_id, login_date, login) values (1, '5/7/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '4/28/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '4/26/2023', 'success');\ninsert into logins (user_id, login_date, login) values (2, '2/5/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '12/22/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '4/22/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/29/2023', 'success');\ninsert into logins (user_id, login_date, login) values (3, '4/19/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '4/6/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '4/16/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '5/22/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '3/10/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/23/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '1/18/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '4/27/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '11/6/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '11/18/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '9/17/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '11/14/2022', 'success');\ninsert into logins (user_id, login_date, login) values (3, '7/23/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '9/13/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '7/3/2022', 'success');\ninsert into logins (user_id, login_date, login) values (1, '12/9/2022', 'success');\ninsert into logins (user_id, login_date, login) values (4, '4/3/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '10/11/2022', 'success');\ninsert into logins (user_id, login_date, login) values (4, '3/16/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '1/10/2023', 'success');\ninsert into logins (user_id, login_date, login) values (3, '12/3/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '7/2/2022', 'success');\ninsert into logins (user_id, login_date, login) values (1, '10/11/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '2/24/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '9/11/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '4/11/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/3/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '1/30/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '10/21/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '7/9/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '8/12/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '5/30/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '8/11/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '10/22/2022', 'success');\ninsert into logins (user_id, login_date, login) values (3, '1/6/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '11/10/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '4/2/2023', 'success');\ninsert into logins (user_id, login_date, login) values (2, '7/17/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '8/6/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '1/11/2023', 'success');\ninsert into logins (user_id, login_date, login) values (2, '2/20/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '1/9/2023', 'success');\ninsert into logins (user_id, login_date, login) values (3, '1/3/2023', 'success');\ninsert into logins (user_id, login_date, login) values (2, '4/17/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '3/7/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/26/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '6/30/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '2/1/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '3/26/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '11/13/2022', 'success');\ninsert into logins (user_id, login_date, login) values (5, '8/11/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '1/30/2023', 'success');\ninsert into logins (user_id, login_date, login) values (3, '12/2/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '9/27/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '10/26/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '2/23/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '12/25/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '8/22/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '5/27/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '8/17/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '10/2/2022', 'success');\ninsert into logins (user_id, login_date, login) values (1, '7/15/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '2/6/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/5/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '8/15/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '8/3/2022', 'success');\ninsert into logins (user_id, login_date, login) values (4, '12/17/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '9/11/2022', 'success');\ninsert into logins (user_id, login_date, login) values (5, '7/6/2022', 'success');\ninsert into logins (user_id, login_date, login) values (5, '1/14/2023', 'success');\ninsert into logins (user_id, login_date, login) values (1, '11/4/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '11/18/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '12/17/2022', 'success');\ninsert into logins (user_id, login_date, login) values (4, '5/2/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '8/14/2022', 'success');\ninsert into logins (user_id, login_date, login) values (1, '7/20/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '10/27/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '2/24/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '9/17/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '10/5/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '1/12/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '4/30/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/14/2023', 'success');\ninsert into logins (user_id, login_date, login) values (2, '10/5/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '7/24/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/3/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '11/27/2022', 'success');\ninsert into logins (user_id, login_date, login) values (1, '3/15/2023', 'success');\n\nבהצלחה!"
  },
  {
    "objectID": "questions/1-consecutive-actions/index.html#תשובות",
    "href": "questions/1-consecutive-actions/index.html#תשובות",
    "title": "זיהוי רצפים בהתחברות",
    "section": "תשובות",
    "text": "תשובות\n\nסרטון הסבר\n\n\n\n1.\n\n\nהצג קוד\n\n\nWITH GROUPS AS (\n  SELECT user_id,\n  login,\n  login_date,\n    ROW_NUMBER() OVER(PARTITION BY user_id order by login_date) - ROW_NUMBER() OVER(PARTITION BY user_id, LOGIN order by login_date asc) as grp\n  FROM LOGINS\n),\n\nlogin_ranks as (\n  SELECT user_id,\n    COUNT(*) AS most_consecutive_logins,\n    ROW_NUMBER() OVER(partition by user_id ORDER BY count(*) desc) as rnk\n  FROM GROUPS\n  where login = 'success'\n  GROUP BY user_id,\n    GRP\n  )\n  \nSELECT user_id,\n  most_consecutive_logins\nFROM LOGIN_RANKS\nWHERE RNK = 1\n\n\n\n\n\n5 records\n\n\nuser_id\nmost_consecutive_logins\n\n\n\n\n1\n1\n\n\n2\n6\n\n\n3\n2\n\n\n4\n1\n\n\n5\n2\n\n\n\n\n\n\n\n2.\n\n\nהצג קוד\n\n\nWITH GROUPS AS (\n  SELECT user_id,\n  login,\n  login_date,\n    ROW_NUMBER() OVER(PARTITION BY user_id order by login_date) - ROW_NUMBER() OVER(PARTITION BY user_id, LOGIN order by login_date asc) as grp\n  FROM LOGINS\n),\n\ngrp_stamps as (\nSELECT user_id,\n  login_date,\n  rn_within_group = ROW_NUMBER() OVER(PARTITION BY user_id, GRP order by grp, login_date)\nFROM GROUPS\nwhere login = 'fail'\n)\n\nselect user_id, \n  min(login_date) AS FIRST_3rd_failed_login\nfrom grp_stamps\nWHERE rn_within_group = 3\nGROUP BY user_id\n\n\n\n\n\n5 records\n\n\nuser_id\nFIRST_3rd_failed_login\n\n\n\n\n1\n2022-08-22\n\n\n2\n2022-09-17\n\n\n3\n2023-04-19\n\n\n4\n2022-12-25\n\n\n5\n2022-10-05"
  },
  {
    "objectID": "website.html",
    "href": "website.html",
    "title": "אודות האתר",
    "section": "",
    "text": "היי!\nברוכים הבאים לאתר שאילתות מהחיים. בבלוג/אוסף של שאלות אני מרכז מקרים מעניינים שיצא לי להתקל בהם במסגרת העבודה. לרוב זה יהיה משהו שפתרתי ואחשוב לעצמי “מגניב! בא לי שעוד אנשים יתנסו בזה” ואעלה את השאלה לפה כדי שתוכלו לנסות לפתור לבד, ולהשוות לפתרון שלי. כמובן כל הדאטה עובר איזשהי אנונימיזציה כך שלא יהיו פרטים מזהים.\nכל שאלה תפורסם עם דאטה לתרגול בסביבה עצמית (אצלכם במחשב). ניתן יהיה להעתיק את הקוד; כמובן שהרצתו היא באחריותכם בלבד. ברגע ששאלה חדשה תצא אעדכן את דרכי הפתרון לשאלה מהשבוע הקודם. על חלק מהשאלות אענה גם בפורמט של סרטון.\nלצערי, המון מעבודת האנליסט לא קיימת בבלוג הזה, וזה שאילת השאלות האנליטיות שיביאו אותנו לכתוב את הקוד שיתן לנו את הדאטה שאנחנו צריכים. עם זאת, אני מאמין שהאתגרים הללו יוכלו לעזור לכם לתרגל בעצמכם ובכך להתכונן למשרה הראשונה/הבאה. חלק מהשאלות יהיו לכם קלות, חלק אולי קשות; מקווה כי מכולם תלמדו!\nהתרגילים מחולקים לשתי רמות קושי שונות: מתקדם ו-בסיסי. אלה תגיות שתוכלו לראות בעמוד הראשי ולסנן שאלות לפיהן. שאלות עם התגית ‘בסיסי’ לא בהכרח קלות למי שכרגע לומד את השפה; הן בסיסיות במובן שהן עולות הרבה בשגרת העבודה שלי. אלה לדעתי גם שאלות שהייתי שואל בריאיון עבודה כדי לסמן וי שהאנליסט יודע SQL. שאלות עם תגית מתקדם הן יותר קשות ונדירות, כאלה שאני נתקל בהן אחת לכמה חודשים.\nאת האתר הרמתי באמצעות Quarto, שזה בגדול פלטפורמה בקוד פתוח לפרסום של דברים, שווה לנסות :)\nמוזמנים להירשם לניוזלטר ולקבל תזכורת כשיוצאת שאלה ויחד איתה הפתרון לשאלה הקודמת. ואם ממש אהבתם/זה עזר לכם מוזמנים עוד יותר לתמוך בי :)\n\n\n\n\n      \n\n    \n        \n            הירשמו וקבלו עידכונים על שאלות חדשות"
  },
  {
    "objectID": "questions/2-identical-different-payments/index.html",
    "href": "questions/2-identical-different-payments/index.html",
    "title": "אפיון תשלומים זהים או שונים",
    "section": "",
    "text": "ברוכים הבאים לתרגיל השני!"
  },
  {
    "objectID": "questions/2-identical-different-payments/index.html#הדאטה",
    "href": "questions/2-identical-different-payments/index.html#הדאטה",
    "title": "אפיון תשלומים זהים או שונים",
    "section": "הדאטה",
    "text": "הדאטה\nבטבלה למטה ניתן לראות פירוט תשלומים של יוזרים:\n\nSELECT TOP 10 *\nFROM payments_ag_2;\n\n\nDisplaying records 1 - 10\n\n\nuser_id\ndate\nstatus\namount\n\n\n\n\n1\n2023-06-01\nLoad\n234\n\n\n1\n2023-06-14\nCancel\n42\n\n\n1\n2023-06-16\nLoad\n52\n\n\n1\n2023-06-22\nLoad\n6\n\n\n1\n2023-06-23\nLoad\n36\n\n\n1\n2023-06-24\nPending\n74\n\n\n2\n2023-06-03\nLoad\n58\n\n\n2\n2023-06-05\nLoad\n33\n\n\n2\n2023-06-09\nLoad\n65\n\n\n2\n2023-06-10\nLoad\n74"
  },
  {
    "objectID": "questions/2-identical-different-payments/index.html#שאלה",
    "href": "questions/2-identical-different-payments/index.html#שאלה",
    "title": "אפיון תשלומים זהים או שונים",
    "section": "שאלה",
    "text": "שאלה\nעבור כל יוזר החזר טבלה עם מספר התשלומים שהוא קיבל, עמודה המציינת האם כל התשלומים שהוא קיבל הם עם סטטוס ‘Load’ (1 כל התשלומים עם הסטטוס הזה, 0 לא), האם מספר התשלומים שנטענו היה גדול ממספר התשלומים שבוטלו (1 כן, 0 לא) והאם יש לו לפחות תשלום אחד שהוא ‘Pending’ (1 כן, 0 לא)\nבהצלחה!"
  },
  {
    "objectID": "questions/2-identical-different-payments/index.html#יצירת-הטבלה",
    "href": "questions/2-identical-different-payments/index.html#יצירת-הטבלה",
    "title": "אפיון תשלומים זהים או שונים",
    "section": "יצירת הטבלה",
    "text": "יצירת הטבלה\n\nDROP table if exists payments_ag_2;\n\n\nCREATE TABLE payments_ag_2\n    ([user_id] int, [date] date, [status] varchar(7), [amount] int)\n;\n    \nINSERT INTO payments_ag_2\n    ([user_id], [date], [status], [amount])\nVALUES\n    (1, '2023-06-01', 'Load', 234),\n    (1, '2023-06-14', 'Cancel', 42),\n    (1, '2023-06-16', 'Load', 52),\n    (1, '2023-06-22', 'Load', 6),\n    (1, '2023-06-23', 'Load', 36),\n    (1, '2023-06-24', 'Pending', 74),\n    (2, '2023-06-03', 'Load', 58),\n    (2, '2023-06-05', 'Load', 33),\n    (2, '2023-06-09', 'Load', 65),\n    (2, '2023-06-10', 'Load', 74),\n    (2, '2023-06-14', 'Load', 98),\n    (2, '2023-06-18', 'Load', 14),\n    (3, '2023-06-01', 'Cancel', 52),\n    (3, '2023-06-04', 'Cancel', 5),\n    (3, '2023-06-07', 'Pending', 99),\n    (4, '2023-06-09', 'Load', 100),\n    (4, '2023-06-10', 'Cancel', 15),\n    (5, '2023-06-15', 'Load', 20),\n    (6, '2023-06-16', 'Pending', 21),\n    (6, '2023-06-16', 'Load', 42)\n;"
  },
  {
    "objectID": "questions/2-identical-different-payments/index.html#תשובה",
    "href": "questions/2-identical-different-payments/index.html#תשובה",
    "title": "אפיון תשלומים זהים או שונים",
    "section": "תשובה",
    "text": "תשובה\n\nסרטון הסבר\n\n\n\nפלט\n\n\nהצג קוד\n\n\nSELECT USER_ID,\n    COUNT(*) AS N_PAYMENTS,\n    CASE WHEN SUM(CASE WHEN STATUS = 'Load' THEN 1 ELSE 0 END) = COUNT(*) THEN 1 ELSE 0 END AS ALL_LOADED,\n    CASE WHEN COUNT(CASE WHEN STATUS = 'Load' THEN 1 END) &gt; COUNT(CASE WHEN STATUS = 'Cancel' THEN 1 END) THEN 1 ELSE 0 END AS more_loaded_than_failed,\n    MAX(CASE WHEN STATUS = 'Pending' THEN 1 ELSE 0 END) AS HAS_PENDING_PAYMENT\nFROM payments_ag_2\nGROUP BY USER_ID\n\n\n\n\n\n6 records\n\n\n\n\n\n\n\n\n\nUSER_ID\nN_PAYMENTS\nALL_LOADED\nmore_loaded_than_failed\nHAS_PENDING_PAYMENT\n\n\n\n\n1\n6\n0\n1\n1\n\n\n2\n6\n1\n1\n0\n\n\n3\n3\n0\n0\n1\n\n\n4\n2\n0\n0\n0\n\n\n5\n1\n1\n1\n0\n\n\n6\n2\n0\n1\n1"
  },
  {
    "objectID": "questions/3-ranking-without-window-function/index.html",
    "href": "questions/3-ranking-without-window-function/index.html",
    "title": "דירוג שורות בלי פונקצית חלון",
    "section": "",
    "text": "ברוכים הבאים לתרגיל השלישי!\nהאמת זו לא ממש שאלה שנדרשתי לה בעבודה אלא שאלה שעלתה בקבוצות פייסבוק לאנליסטים וראיתי כי איציק בן-גן דן בה גם בספר שלו על פונקציות חלון.\nתכלס, ברוב המקרים תוכלו להשתמש בפונקצית חלון, אבל נראה לי זה תרגול מגניב שדורש מאיתנו לחשוב מה בפועל קורה בפונקצית דירוג ובכך לשחזר אותה."
  },
  {
    "objectID": "questions/3-ranking-without-window-function/index.html#הדאטה",
    "href": "questions/3-ranking-without-window-function/index.html#הדאטה",
    "title": "דירוג שורות בלי פונקצית חלון",
    "section": "הדאטה",
    "text": "הדאטה\nהאמת זו לא ממש שאלה שנדרשתי לה בעבודה אלא שאלה שעלתה בקבוצות פייסבוק לאנליסטים ואיציק בן גן דן בה גם בספר שלו על פונקציות חלון.\nאומנם ברוב הגדול של הפעמים תוכלו להשתמש בפונקצית חלון, התרגול דורש מאיתנו לחשוב מה קורה בפונקציית דירוג וכך לשחזר אותה רק בלי להשתמש בפונקציית חלון"
  },
  {
    "objectID": "questions/3-ranking-without-window-function/index.html#שאלה",
    "href": "questions/3-ranking-without-window-function/index.html#שאלה",
    "title": "דירוג שורות בלי פונקצית חלון",
    "section": "שאלה",
    "text": "שאלה\nללא שימוש בשום פונקצית חלון, צרו עמודה חדשה שמדרגת את השורות לפי מכירות (amount) באותה שנה (sale_year), בדומה לפונקצית DESNE_RANK(). כלומר, בהינתן תיקו בהיררכיה, ערכים זהים יקבלו את אותו דירוג ואילו הערכים הבאים בסדר יקבלו דירוג אחד מעל הערך הקודם שהיה בתיקו.\nבהצלחה!"
  },
  {
    "objectID": "questions/3-ranking-without-window-function/index.html#יצירת-הטבלה",
    "href": "questions/3-ranking-without-window-function/index.html#יצירת-הטבלה",
    "title": "דירוג שורות בלי פונקצית חלון",
    "section": "יצירת הטבלה",
    "text": "יצירת הטבלה\n\nDROP TABLE IF EXISTS Sales_ag;\n\nCREATE TABLE sales_ag (\n    year INT,\n    category varchar(15),\n    amount INT\n)\n\n\nINSERT into Sales_ag (year, category, amount) values (2000, 'Automotive', 89);\ninsert into Sales_ag (year, category, amount) values (2000, 'Computers', 59);\ninsert into Sales_ag (year, category, amount) values (2000, 'Books', 19);\ninsert into Sales_ag (year, category, amount) values (2000, 'Movies', 74);\ninsert into Sales_ag (year, category, amount) values (2000, 'Garden', 74);\ninsert into Sales_ag (year, category, amount) values (2001, 'Clothing', 49);\ninsert into Sales_ag (year, category, amount) values (2001, 'Computers', 53);\ninsert into Sales_ag (year, category, amount) values (2001, 'Automotive', 65);\ninsert into Sales_ag (year, category, amount) values (2001, 'Garden', 24);\ninsert into Sales_ag (year, category, amount) values (2001, 'Movies', 39);"
  },
  {
    "objectID": "questions/3-ranking-without-window-function/index.html#תשובה",
    "href": "questions/3-ranking-without-window-function/index.html#תשובה",
    "title": "דירוג שורות בלי פונקצית חלון",
    "section": "תשובה",
    "text": "תשובה\n\nסרטון הסבר\n\n\n\nהצג פתרון\n\n\nSELECT *,\n    (SELECT COUNT(DISTINCT SalesInner.amount) as rn\n    FROM sales_ag SalesInner\n    WHERE SalesInner.year = SalesOuter.year\n        AND SalesInner.amount &gt;= SalesOuter.amount)  AS custom_dense_rank\nFROM sales_ag SalesOuter\nORDER BY year, custom_dense_rank\n\n\n\n\n\n\n\n\n\n\n\ncustom_dense_rank\namount\ncategory\nsale_year\n\n\n\n\n1\n89\nAutomotive\n2000\n\n\n2\n74\nMovies\n2000\n\n\n2\n74\nGarden\n2000\n\n\n3\n59\nComputers\n2000\n\n\n4\n19\nBooks\n2000\n\n\n1\n65\nAutomotive\n2001\n\n\n2\n53\nComputers\n2001\n\n\n3\n49\nClothing\n2001\n\n\n4\n39\nMovies\n2001\n\n\n5\n24\nGarden\n2001"
  },
  {
    "objectID": "questions/4-before-and-after/index.html",
    "href": "questions/4-before-and-after/index.html",
    "title": "ערכים לפני ואחרי נקודת זמן",
    "section": "",
    "text": "ברוכים הבאים לתרגיל הרביעי!"
  },
  {
    "objectID": "questions/4-before-and-after/index.html#הדאטה",
    "href": "questions/4-before-and-after/index.html#הדאטה",
    "title": "ערכים לפני ואחרי נקודת זמן",
    "section": "הדאטה",
    "text": "הדאטה\nהתרגיל מורכב מ-2 טבלאות: טבלת תשלומים וטבלת ציוני ‘סכנת נטישה’ (עוד הסבר למטה).\nטבלת תשלומים:\n\nSELECT TOP 5 * \nFROM payments_ag_4\norder by payment_date;\n\n\n5 records\n\n\nuser_id\npayment_date\namount\n\n\n\n\n1\n2022-10-13\n71.7\n\n\n2\n2022-10-14\n73.9\n\n\n4\n2022-10-14\n52.6\n\n\n4\n2022-10-16\n42.0\n\n\n5\n2022-10-19\n62.5\n\n\n\n\n\nטבלת ציוני סכנת נטישה:\n\nSELECT TOP 5 * \nFROM churn_scores_ag_4\norder by score_date;\n\n\n5 records\n\n\nuser_id\nscore_date\nchurn_score\n\n\n\n\n2\n2022-08-01\n70\n\n\n3\n2022-08-03\n39\n\n\n3\n2022-08-04\n9\n\n\n3\n2022-08-04\n100\n\n\n1\n2022-08-08\n64"
  },
  {
    "objectID": "questions/4-before-and-after/index.html#שאלה-1",
    "href": "questions/4-before-and-after/index.html#שאלה-1",
    "title": "ערכים לפני ואחרי נקודת זמן",
    "section": "שאלה 1",
    "text": "שאלה 1\nלכל יוזר יש ציוני ‘סכנת נטישה’ המעידים על הסיכוי של אותו יוזר לנטוש את הפלטפורמה לנקודת זמן מסוימת (נע בין 1-100, כאשר ציון גבוה יותר מעיד על סיכוי גבוה יותר לנטישה).\nעבור כל יוזר יש לחלץ את התשלום הראשון שקיבל ושני תאריכי סכנת נטישה: התאריך המאוחר ביותר שמתועד לפני קבלת התשלום הראשון, והתאריך המוקדם ביותר שמתועד לאחר התשלום הראשון.\n\nדוגמא\n\n\nלחץ להצגת הדוגמא\n\n\nלדוג’, להלן טבלת ציוני ‘סכנת נטישה’ ליוזר כלשהו:\n\nSELECT TOP 5 * \nFROM churn_scores_ag_4\nwhere user_id = 1\norder by score_date;\n\n\n5 records\n\n\nuser_id\nscore_date\nchurn_score\n\n\n\n\n1\n2022-08-08\n64\n\n\n1\n2022-09-11\n29\n\n\n1\n2022-11-01\n23\n\n\n1\n2022-11-17\n91\n\n\n1\n2022-12-05\n36\n\n\n\n\n\nולהלן דגימה מתוך התשלומים הראשונים שלו:\n\nSELECT TOP 5 * \nFROM payments_ag_4\nwhere user_id = 1\norder by payment_date;\n\n\n3 records\n\n\nuser_id\npayment_date\namount\n\n\n\n\n1\n2022-10-13\n71.7\n\n\n1\n2022-11-10\n61.8\n\n\n1\n2022-11-13\n4.0\n\n\n\n\n\nניתן לראות שהציון ‘סכנת נטישה’ המאוחר ביותר לפני התשלום הראשוני באוקטובר 2022 הוא 2022-09-11 ואילו ציון ‘סכנת נטישה’ המוקדם ביותר לאחר התשלום הראשוני הוא 2022-11-01\nלכן, אנחנו נרצה להחזיר את הרשומה הבאה ליוזר 1:\n\n\n\n1 records\n\n\n\n\n\n\n\n\nuser_id\nscore_date_before_paymet\nfirst_payment\nscore_date_after_paymet\n\n\n\n\n1\n2022-09-11\n2022-10-13\n2022-11-01"
  },
  {
    "objectID": "questions/4-before-and-after/index.html#שאלה-2",
    "href": "questions/4-before-and-after/index.html#שאלה-2",
    "title": "ערכים לפני ואחרי נקודת זמן",
    "section": "שאלה 2",
    "text": "שאלה 2\nצרו פלט נוסף שבו במקום תאריכים מופיעים ציוני סכנת הנטישה (הציון לפני התשלום הראשון והציון מיד לאחר התשלום הראשון)"
  },
  {
    "objectID": "questions/4-before-and-after/index.html#יצירת-הטבלאות",
    "href": "questions/4-before-and-after/index.html#יצירת-הטבלאות",
    "title": "ערכים לפני ואחרי נקודת זמן",
    "section": "יצירת הטבלאות",
    "text": "יצירת הטבלאות\n\nתשלומים\n\n\ncreate table payments_ag_4 (\n    user_id INT,\n    payment_date DATE,\n    amount DECIMAL(4,1)\n);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (4, '11/26/2022', 89.7);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (5, '11/29/2022', 57.5);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (4, '10/14/2022', 52.6);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (5, '12/3/2022', 18.3);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '10/14/2022', 73.9);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (5, '11/30/2022', 4.2);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (1, '11/13/2022', 4.0);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '11/9/2022', 97.3);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (3, '10/22/2022', 4.6);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (4, '10/16/2022', 42.0);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (4, '12/6/2022', 89.6);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (5, '11/29/2022', 36.9);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (5, '10/19/2022', 62.5);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (1, '11/10/2022', 61.8);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '10/31/2022', 17.5);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '11/10/2022', 5.7);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (1, '10/13/2022', 71.7);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '11/2/2022', 35.8);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (4, '11/21/2022', 52.3);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '10/19/2022', 31.2);\n\n\n\nציון סכנת נטישה\n\n\ndrop table if exists churn_scores_ag_4;\n\ncreate table churn_scores_ag_4 (\n    user_id INT,\n    score_date DATE,\n    churn_score INT\n);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '4/3/2023', 11);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '1/1/2023', 97);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '11/17/2022', 91);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '4/23/2023', 84);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '12/9/2022', 92);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/22/2023', 7);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '4/27/2023', 19);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '9/1/2022', 42);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '11/26/2022', 69);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '12/16/2022', 38);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '3/27/2023', 22);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '3/21/2023', 32);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '2/2/2023', 55);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/26/2023', 57);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/3/2023', 24);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '4/22/2023', 98);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '10/13/2022', 38);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '11/23/2022', 77);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '10/6/2022', 31);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '8/31/2022', 92);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '12/21/2022', 97);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '10/22/2022', 49);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '1/3/2023', 60);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '3/29/2023', 93);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '1/9/2023', 81);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '10/25/2022', 72);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '3/9/2023', 97);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '3/19/2023', 91);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/28/2023', 9);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/19/2023', 2);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '3/23/2023', 29);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '11/13/2022', 80);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '3/18/2023', 24);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '3/31/2023', 34);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '1/4/2023', 68);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '2/3/2023', 10);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '11/2/2022', 40);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/26/2023', 37);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '11/30/2022', 59);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '8/8/2022', 64);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '8/4/2022', 9);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '8/3/2022', 39);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '1/28/2023', 83);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '8/27/2022', 49);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '12/28/2022', 3);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '3/15/2023', 73);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '4/30/2023', 57);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '1/21/2023', 36);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '9/11/2022', 29);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '8/15/2022', 4);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '3/6/2023', 78);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '10/22/2022', 58);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '11/3/2022', 14);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '8/1/2022', 70);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '10/27/2022', 42);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '3/6/2023', 19);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '8/4/2022', 100);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/21/2023', 15);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '9/10/2022', 31);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '1/2/2023', 44);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '8/18/2022', 35);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '10/22/2022', 4);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '3/21/2023', 29);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '8/15/2022', 79);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '2/25/2023', 44);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '1/21/2023', 87);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '1/14/2023', 81);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '10/24/2022', 99);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '12/7/2022', 54);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '3/13/2023', 39);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '9/9/2022', 10);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '11/1/2022', 23);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '2/28/2023', 88);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '3/29/2023', 85);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '12/3/2022', 8);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '1/22/2023', 24);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '3/19/2023', 6);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '9/30/2022', 89);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '2/5/2023', 33);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '4/15/2023', 59);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '1/13/2023', 59);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '3/16/2023', 63);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '8/26/2022', 89);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '12/31/2022', 70);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '12/21/2022', 100);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '4/27/2023', 91);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '8/29/2022', 100);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '9/11/2022', 99);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '9/27/2022', 4);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '12/5/2022', 36);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '9/24/2022', 18);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '9/19/2022', 68);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '12/7/2022', 72);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '12/25/2022', 72);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '1/6/2023', 8);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '9/14/2022', 6);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '2/1/2023', 11);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '9/14/2022', 10);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '3/27/2023', 82);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '11/27/2022', 90);"
  },
  {
    "objectID": "questions/4-before-and-after/index.html#תשובות",
    "href": "questions/4-before-and-after/index.html#תשובות",
    "title": "ערכים לפני ואחרי נקודת זמן",
    "section": "תשובות",
    "text": "תשובות\n\nסרטון הסבר\n\n\n\nתשובה 1\n\n\nהצג פתרון\n\n\nWITH user_payment as (\n  SELECT user_id,\n    min(payment_date) as first_payment\n  FROM payments_ag_4\n  GROUP BY user_id\n  )\n\nSELECT user_payment.user_id,\n  max(CASE WHEN first_payment &gt; score_date then score_date END) as score_date_before_paymet,\n  first_payment,\n  min(CASE WHEN first_payment &lt; score_date then score_date END) as score_date_after_paymet\nFROM user_payment  \nLEFT JOIN churn_scores_ag_4 scores on scores.user_id = user_payment.user_id\nGROUP BY user_payment.user_id, first_payment;\n\n\n\n\n\n5 records\n\n\n\n\n\n\n\n\nuser_id\nscore_date_before_paymet\nfirst_payment\nscore_date_after_paymet\n\n\n\n\n1\n2022-09-11\n2022-10-13\n2022-11-01\n\n\n2\n2022-10-13\n2022-10-14\n2022-10-22\n\n\n3\n2022-09-19\n2022-10-22\n2022-10-27\n\n\n4\n2022-10-06\n2022-10-14\n2022-10-22\n\n\n5\n2022-09-24\n2022-10-19\n2022-10-24\n\n\n\n\n\n\n\nתשובה 2\n\n\nהצג פתרון\n\nשימו לב, הפתרון נכתב בסינטקס T-SQL ולא יעבוד בתיבת טקסט להרצת SQL למעלה. מוזמנים להיעזר בתגובות למציאת פתרון מתאים ל-SQLite.\n\nWITH user_payment as (\n  SELECT user_id,\n    min(payment_date) as first_payment\n  FROM payments_ag_4\n  GROUP BY user_id\n  )\n\nSELECT user_payment.user_id,\n   first_payment,\n  churn_scores.score_before_payment,\n  churn_scores.score_after_payment\nFROM user_payment\nOUTER APPLY (\n  SELECT top 1\n   FIRST_VALUE(churn_score) OVER(ORDER BY CASE WHEN score_date &lt; first_payment THEN 1 ELSE 2 END, score_date desc) as score_before_payment,\n   FIRST_VALUE(churn_score) OVER(ORDER BY CASE WHEN score_date &gt; first_payment THEN 1 ELSE 2 END, score_date asc)  as score_after_payment \n  from churn_scores_ag_4 scores\n  where scores.user_id = user_payment.user_id\n) AS churn_scores\n\n\n\n\n\n5 records\n\n\nuser_id\nfirst_payment\nscore_before_payment\nscore_after_payment\n\n\n\n\n1\n2022-10-13\n29\n23\n\n\n2\n2022-10-14\n38\n4\n\n\n3\n2022-10-22\n68\n42\n\n\n4\n2022-10-14\n31\n49\n\n\n5\n2022-10-19\n18\n99"
  },
  {
    "objectID": "questions/5-extract-text-from-logs/index.html",
    "href": "questions/5-extract-text-from-logs/index.html",
    "title": "חילוץ טקסט",
    "section": "",
    "text": "ברוכים הבאים לתרגיל החמישי!"
  },
  {
    "objectID": "questions/5-extract-text-from-logs/index.html#הדאטה",
    "href": "questions/5-extract-text-from-logs/index.html#הדאטה",
    "title": "חילוץ טקסט",
    "section": "הדאטה",
    "text": "הדאטה\nהתרגיל מורכב מטבלת לוגים לכל יוזר:\n\nSELECT TOP 5 * \nFROM LOGS_Q5\n\n\n5 records\n\n\n\n\n\n\n\nuser_id\nlog_date\nlog_text\n\n\n\n\n1\n2023-09-20\nuser 1 registered in 2018. Closure reason: Duplicate account.\n\n\n2\n2023-04-01\nuser 2 registered in 2022. Closure reason: Fraudulent behaviour.\n\n\n3\n2023-06-26\nuser 3 registered in 2016. Closure reason: Unsupported activity. Current status: open. Account has been re-opened\n\n\n4\n2023-06-21\nuser 4 registered in 2016. Closure reason: Did not provide relevant documents. Current status: open. Account has been re-opened\n\n\n5\n2023-02-04\nuser 5 registered in 2017. Closure reason: Unsupported activity."
  },
  {
    "objectID": "questions/5-extract-text-from-logs/index.html#שאלה-1",
    "href": "questions/5-extract-text-from-logs/index.html#שאלה-1",
    "title": "חילוץ טקסט",
    "section": "שאלה 1",
    "text": "שאלה 1\nמתוך כל טקסט בלוג חלצו את השנה בה נרשם היוזר וסכמו את מספר המופעים של כל שנה. סדרו את הפלט לפי שנים (השנה העדכנית ביותר תופיע ראשונה וכן הלאה).\n[פלט למטה]"
  },
  {
    "objectID": "questions/5-extract-text-from-logs/index.html#שאלה-2",
    "href": "questions/5-extract-text-from-logs/index.html#שאלה-2",
    "title": "חילוץ טקסט",
    "section": "שאלה 2",
    "text": "שאלה 2\nהלוגים מעט שונים אחד מהשני אבל בכולם יש סיבת סגירה של יוזר. חלצו את סיבות הסגירה השונות וסכמו אותן. את הפלט סדרו באופן יורד כך שהסיבה עם מספר המופעים הרב ביותר תופיע ראשונה.\n\n\nרמז\n\nשימו לב למבנה של הלוג — מה מופיע לפני הסיבה? מה יכול להופיע אחרי הסיבה? איך אפשר להיעזר בזה כדי לחלץ את מה שאנחנו צריכים?"
  },
  {
    "objectID": "questions/5-extract-text-from-logs/index.html#יצירת-הטבלה",
    "href": "questions/5-extract-text-from-logs/index.html#יצירת-הטבלה",
    "title": "חילוץ טקסט",
    "section": "יצירת הטבלה",
    "text": "יצירת הטבלה\n\n\nDROP TABLE IF EXISTS LOGS_Q5;\n\nCREATE TABLE LOGS_Q5\n    (user_id int, log_date datetime, log_text varchar(128))\n;\n    \nINSERT INTO LOGS_Q5\n    (user_id, log_date, log_text)\nVALUES\n    (1, '2023-09-20 00:00:00', 'user 1 registered in 2018. Closure reason: Duplicate account.'),\n    (2, '2023-04-01 00:00:00', 'user 2 registered in 2022. Closure reason: Fraudulent behaviour.'),\n    (3, '2023-06-26 00:00:00', 'user 3 registered in 2016. Closure reason: Unsupported activity. Current status: open. Account has been re-opened'),\n    (4, '2023-06-21 00:00:00', 'user 4 registered in 2016. Closure reason: Did not provide relevant documents. Current status: open. Account has been re-opened'),\n    (5, '2023-02-04 00:00:00', 'user 5 registered in 2017. Closure reason: Unsupported activity.'),\n    (6, '2023-03-09 00:00:00', 'user 6 registered in 2022. Closure reason: Fraudulent behaviour. Current status: open. Account has been re-opened'),\n    (7, '2023-01-17 00:00:00', 'user 7 registered in 2018. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (8, '2023-09-12 00:00:00', 'user 8 registered in 2019. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (9, '2023-01-17 00:00:00', 'user 9 registered in 2014. Closure reason: Duplicate account. Current status: account closed.'),\n    (10, '2023-09-17 00:00:00', 'user 10 registered in 2018. Closure reason: Requested to close. Current status: account closed.'),\n    (11, '2023-01-06 00:00:00', 'user 11 registered in 2014. Closure reason: Unsupported activity. Current status: open. Account has been re-opened'),\n    (12, '2023-05-28 00:00:00', 'user 12 registered in 2015. Closure reason: Requested to close.'),\n    (13, '2023-09-09 00:00:00', 'user 13 registered in 2015. Closure reason: Fraudulent behaviour.'),\n    (14, '2023-04-08 00:00:00', 'user 14 registered in 2015. Closure reason: Duplicate account. Current status: open.'),\n    (15, '2023-03-19 00:00:00', 'user 15 registered in 2018. Closure reason: Duplicate account.'),\n    (16, '2023-10-09 00:00:00', 'user 16 registered in 2022. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (17, '2023-05-19 00:00:00', 'user 17 registered in 2015. Closure reason: Fraudulent behaviour. Current status: open. Account has been re-opened'),\n    (18, '2023-01-22 00:00:00', 'user 18 registered in 2016. Closure reason: Unsupported activity. Current status: account closed.'),\n    (19, '2023-08-30 00:00:00', 'user 19 registered in 2022. Closure reason: Fraudulent behaviour.'),\n    (20, '2023-09-26 00:00:00', 'user 20 registered in 2016. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (21, '2023-04-20 00:00:00', 'user 21 registered in 2015. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (22, '2023-05-02 00:00:00', 'user 22 registered in 2020. Closure reason: Duplicate account. Current status: account closed.'),\n    (23, '2023-04-18 00:00:00', 'user 23 registered in 2021. Closure reason: Duplicate account. Current status: account closed.'),\n    (24, '2023-07-27 00:00:00', 'user 24 registered in 2020. Closure reason: Requested to close.'),\n    (25, '2023-08-25 00:00:00', 'user 25 registered in 2020. Closure reason: Requested to close. Current status: open. Account has been re-opened'),\n    (26, '2023-07-22 00:00:00', 'user 26 registered in 2022. Closure reason: Fraudulent behaviour.'),\n    (27, '2023-01-28 00:00:00', 'user 27 registered in 2016. Closure reason: Unsupported activity. Current status: open.'),\n    (28, '2023-05-20 00:00:00', 'user 28 registered in 2017. Closure reason: Requested to close. Current status: open.'),\n    (29, '2023-09-10 00:00:00', 'user 29 registered in 2017. Closure reason: Unsupported activity.'),\n    (30, '2023-05-28 00:00:00', 'user 30 registered in 2019. Closure reason: Did not provide relevant documents. Current status: open. Account has been re-opened'),\n    (31, '2023-08-27 00:00:00', 'user 31 registered in 2018. Closure reason: Requested to close. Current status: account closed.'),\n    (32, '2023-01-08 00:00:00', 'user 32 registered in 2014. Closure reason: Fraudulent behaviour.'),\n    (33, '2023-07-20 00:00:00', 'user 33 registered in 2021. Closure reason: Unsupported activity. Current status: account closed.'),\n    (34, '2023-01-31 00:00:00', 'user 34 registered in 2016. Closure reason: Duplicate account. Current status: open.'),\n    (35, '2023-07-08 00:00:00', 'user 35 registered in 2019. Closure reason: Unsupported activity.'),\n    (36, '2023-07-31 00:00:00', 'user 36 registered in 2016. Closure reason: Requested to close. Current status: account closed.'),\n    (37, '2023-02-02 00:00:00', 'user 37 registered in 2019. Closure reason: Did not provide relevant documents. Current status: open.'),\n    (38, '2023-03-07 00:00:00', 'user 38 registered in 2016. Closure reason: Fraudulent behaviour.'),\n    (39, '2023-06-11 00:00:00', 'user 39 registered in 2017. Closure reason: Duplicate account. Current status: account closed.'),\n    (40, '2023-05-21 00:00:00', 'user 40 registered in 2014. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (41, '2023-08-12 00:00:00', 'user 41 registered in 2020. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (42, '2023-09-09 00:00:00', 'user 42 registered in 2018. Closure reason: Duplicate account.'),\n    (43, '2023-05-26 00:00:00', 'user 43 registered in 2014. Closure reason: Did not provide relevant documents.'),\n    (44, '2023-03-06 00:00:00', 'user 44 registered in 2016. Closure reason: Duplicate account. Current status: account closed.'),\n    (45, '2023-08-07 00:00:00', 'user 45 registered in 2016. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (46, '2023-10-04 00:00:00', 'user 46 registered in 2017. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (47, '2023-01-28 00:00:00', 'user 47 registered in 2019. Closure reason: Fraudulent behaviour. Current status: open. Account has been re-opened'),\n    (48, '2023-01-17 00:00:00', 'user 48 registered in 2021. Closure reason: Did not provide relevant documents. Current status: open. Account has been re-opened'),\n    (49, '2023-02-26 00:00:00', 'user 49 registered in 2015. Closure reason: Unsupported activity. Current status: account closed.'),\n    (50, '2023-06-19 00:00:00', 'user 50 registered in 2015. Closure reason: Duplicate account.'),\n    (51, '2023-01-13 00:00:00', 'user 51 registered in 2015. Closure reason: Duplicate account. Current status: open.'),\n    (52, '2023-03-02 00:00:00', 'user 52 registered in 2017. Closure reason: Did not provide relevant documents.'),\n    (53, '2023-01-14 00:00:00', 'user 53 registered in 2014. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (54, '2023-09-13 00:00:00', 'user 54 registered in 2018. Closure reason: Requested to close. Current status: open.'),\n    (55, '2023-07-17 00:00:00', 'user 55 registered in 2017. Closure reason: Requested to close. Current status: open. Account has been re-opened'),\n    (56, '2023-10-12 00:00:00', 'user 56 registered in 2018. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (57, '2023-09-27 00:00:00', 'user 57 registered in 2016. Closure reason: Duplicate account. Current status: open.'),\n    (58, '2023-02-15 00:00:00', 'user 58 registered in 2017. Closure reason: Did not provide relevant documents. Current status: open.'),\n    (59, '2023-10-26 00:00:00', 'user 59 registered in 2021. Closure reason: Duplicate account. Current status: account closed.'),\n    (60, '2023-07-10 00:00:00', 'user 60 registered in 2020. Closure reason: Unsupported activity. Current status: open.'),\n    (61, '2023-09-09 00:00:00', 'user 61 registered in 2020. Closure reason: Fraudulent behaviour.'),\n    (62, '2023-07-12 00:00:00', 'user 62 registered in 2017. Closure reason: Fraudulent behaviour.'),\n    (63, '2023-01-11 00:00:00', 'user 63 registered in 2017. Closure reason: Duplicate account. Current status: open.'),\n    (64, '2023-02-27 00:00:00', 'user 64 registered in 2020. Closure reason: Unsupported activity. Current status: open.'),\n    (65, '2023-07-12 00:00:00', 'user 65 registered in 2021. Closure reason: Did not provide relevant documents.'),\n    (66, '2023-03-09 00:00:00', 'user 66 registered in 2014. Closure reason: Requested to close. Current status: open. Account has been re-opened'),\n    (67, '2023-10-31 00:00:00', 'user 67 registered in 2022. Closure reason: Duplicate account.'),\n    (68, '2023-06-26 00:00:00', 'user 68 registered in 2018. Closure reason: Duplicate account. Current status: open.'),\n    (69, '2023-04-22 00:00:00', 'user 69 registered in 2022. Closure reason: Did not provide relevant documents. Current status: open.'),\n    (70, '2023-09-22 00:00:00', 'user 70 registered in 2015. Closure reason: Unsupported activity.'),\n    (71, '2023-10-04 00:00:00', 'user 71 registered in 2016. Closure reason: Duplicate account. Current status: open.'),\n    (72, '2023-10-31 00:00:00', 'user 72 registered in 2020. Closure reason: Unsupported activity.'),\n    (73, '2023-04-20 00:00:00', 'user 73 registered in 2020. Closure reason: Did not provide relevant documents. Current status: open.'),\n    (74, '2023-10-15 00:00:00', 'user 74 registered in 2017. Closure reason: Duplicate account. Current status: account closed.'),\n    (75, '2023-07-23 00:00:00', 'user 75 registered in 2021. Closure reason: Fraudulent behaviour.'),\n    (76, '2023-03-15 00:00:00', 'user 76 registered in 2017. Closure reason: Duplicate account.'),\n    (77, '2023-10-27 00:00:00', 'user 77 registered in 2019. Closure reason: Requested to close. Current status: account closed.'),\n    (78, '2023-02-03 00:00:00', 'user 78 registered in 2022. Closure reason: Requested to close. Current status: account closed.'),\n    (79, '2023-08-09 00:00:00', 'user 79 registered in 2019. Closure reason: Duplicate account.'),\n    (80, '2023-05-19 00:00:00', 'user 80 registered in 2021. Closure reason: Requested to close.'),\n    (81, '2023-01-02 00:00:00', 'user 81 registered in 2020. Closure reason: Duplicate account. Current status: open. Account has been re-opened'),\n    (82, '2023-08-08 00:00:00', 'user 82 registered in 2020. Closure reason: Duplicate account. Current status: open. Account has been re-opened'),\n    (83, '2023-04-25 00:00:00', 'user 83 registered in 2021. Closure reason: Duplicate account.'),\n    (84, '2023-04-24 00:00:00', 'user 84 registered in 2020. Closure reason: Duplicate account.'),\n    (85, '2023-01-15 00:00:00', 'user 85 registered in 2021. Closure reason: Fraudulent behaviour.'),\n    (86, '2023-01-11 00:00:00', 'user 86 registered in 2020. Closure reason: Duplicate account. Current status: account closed.'),\n    (87, '2023-08-08 00:00:00', 'user 87 registered in 2021. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (88, '2023-01-27 00:00:00', 'user 88 registered in 2015. Closure reason: Unsupported activity.'),\n    (89, '2023-08-31 00:00:00', 'user 89 registered in 2020. Closure reason: Unsupported activity. Current status: account closed.'),\n    (90, '2023-07-26 00:00:00', 'user 90 registered in 2021. Closure reason: Duplicate account. Current status: account closed.'),\n    (91, '2023-07-10 00:00:00', 'user 91 registered in 2014. Closure reason: Unsupported activity. Current status: account closed.'),\n    (92, '2023-07-18 00:00:00', 'user 92 registered in 2017. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (93, '2023-08-19 00:00:00', 'user 93 registered in 2021. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (94, '2023-01-26 00:00:00', 'user 94 registered in 2015. Closure reason: Duplicate account.'),\n    (95, '2023-08-14 00:00:00', 'user 95 registered in 2019. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (96, '2023-05-11 00:00:00', 'user 96 registered in 2022. Closure reason: Fraudulent behaviour.'),\n    (97, '2023-08-03 00:00:00', 'user 97 registered in 2020. Closure reason: Duplicate account. Current status: open. Account has been re-opened'),\n    (98, '2023-01-17 00:00:00', 'user 98 registered in 2017. Closure reason: Unsupported activity. Current status: open.'),\n    (99, '2023-10-08 00:00:00', 'user 99 registered in 2021. Closure reason: Did not provide relevant documents.'),\n    (100, '2023-10-18 00:00:00', 'user 100 registered in 2019. Closure reason: Duplicate account. Current status: open. Account has been re-opened')\n;"
  },
  {
    "objectID": "questions/5-extract-text-from-logs/index.html#תשובות",
    "href": "questions/5-extract-text-from-logs/index.html#תשובות",
    "title": "חילוץ טקסט",
    "section": "תשובות",
    "text": "תשובות\n(שימו לב שהפתרון נכתב ב-T-SQL ולא יעבוד בתיבת טקסט-SQL למעלה)\n\nסרטון הסבר\n\n\n\nתשובה 1\n\n\nהצג פתרון\n\n\nSELECT  \n    registered_year = SUBSTRING(LOG_TEXT, CHARINDEX('registered in ', LOG_TEXT) + len('registered in.'), 4), -- LEN() ignores trailing spaces so a sapce is replaces with a period\n    COUNT(*) AS n\nFROM logs_q5\nGROUP BY SUBSTRING(LOG_TEXT, CHARINDEX('registered in ', LOG_TEXT) + len('registered in.'), 4)\nORDER BY registered_year DESC;\n\n\n\n\n\n9 records\n\n\nregistered_year\nn\n\n\n\n\n2022\n9\n\n\n2021\n13\n\n\n2020\n15\n\n\n2019\n9\n\n\n2018\n9\n\n\n2017\n14\n\n\n2016\n12\n\n\n2015\n11\n\n\n2014\n8\n\n\n\n\n\n\n\nתשובה 2\n\n\nהצג פתרון\n\n\n\nWITH reason_extracted as (\n    SELECT\n    reason = REPLACE(\n        SUBSTRING(\n            log_text,\n            CHARINDEX('closure reason: ', log_text) + LEN('closure reason: '),\n            CASE\n                WHEN CHARINDEX('Current status', log_text) = 0 THEN LEN(log_text)\n            ELSE CHARINDEX('Current status', log_text) - CHARINDEX('closure reason: ',log_text) - LEN('closure reason: ')\n                END),\n        '.', '')\n    FROM logs_q5\n)\n\nSELECT reason,\n    COUNT(*) AS n\nFROM reason_extracted\nGROUP BY reason\nORDER BY n desc\n\n\n\n\n\n5 records\n\n\nreason\nn\n\n\n\n\nDuplicate account\n30\n\n\nFraudulent behaviour\n23\n\n\nDid not provide relevant documents\n17\n\n\nUnsupported activity\n17\n\n\nRequested to close\n13"
  },
  {
    "objectID": "questions/6-implementing-formulas/index.html",
    "href": "questions/6-implementing-formulas/index.html",
    "title": "יישום נוסחאות בקוד",
    "section": "",
    "text": "ברוכים הבאים לתרגיל השישי!"
  },
  {
    "objectID": "questions/6-implementing-formulas/index.html#הדאטה",
    "href": "questions/6-implementing-formulas/index.html#הדאטה",
    "title": "יישום נוסחאות בקוד",
    "section": "הדאטה",
    "text": "הדאטה\nהתרגיל מורכב מטבלת פריטי כלי בית והסכום שבו הם נמכרו:\n\nSELECT TOP 5 * \nFROM Items_q6\n\n\n5 records\n\n\ncategory\namount\n\n\n\n\nChairs\n12\n\n\nChairs\n10\n\n\nChairs\n10\n\n\nChairs\n44\n\n\nChairs\n93"
  },
  {
    "objectID": "questions/6-implementing-formulas/index.html#שאלה-1",
    "href": "questions/6-implementing-formulas/index.html#שאלה-1",
    "title": "יישום נוסחאות בקוד",
    "section": "שאלה 1",
    "text": "שאלה 1\nהינכם מתבקשים למדוד את מקדם השונות (Coefficient of Variation) של כל קטגוריה מפריטי הבית.\nהנוסחה למדידת אותו מקדם היא כדלקמן:\n\\[\nCV = \\frac{\\sigma}{\\mu}\n\\]\nכלומר, חלוקת סטיית התקן של הקבוצה בממוצע שלה. יש למיין את הפלט בסדר יורד של ערכי ה-CV; קטגוריות עם ערך נמוך יותר יופיעו ראשונים וכן הלאה."
  },
  {
    "objectID": "questions/6-implementing-formulas/index.html#שאלה-2",
    "href": "questions/6-implementing-formulas/index.html#שאלה-2",
    "title": "יישום נוסחאות בקוד",
    "section": "שאלה 2",
    "text": "שאלה 2\nהתבקשם ‘לנרמל’ את עמודת הסכום בדאטה וליצור עמודה חדשה כך שכל הערכים המקוריים בכל קבוצה יהיו בטווח ערכים זהה של 0-100: הערך הכי גדול בכל קבוצה ימופה ל-100 ואילו הערך הקטן ביותר יהיה 0, וכך כל הערכים המקוריים ימופו לטווח הערכים ביניהם.\nכדי לנרמל את עמודת ה-Amount, השתמשו בנוסחה הבאה:\n\\[\nZ_i = \\frac{X_i - min(x)}{max(x) - min(x)} * 100\n\\] כאשר:\n\n\\(Z_i\\): זה הערך \\(i\\) המנורמל החדש\n\\(X_i\\): הערך \\(i\\) שעובר נרמול\n\\(min(x)\\): הערך המינימלי במערך \\(X\\)\n\\(max(x)\\): הערך המקסימלי במערך \\(X\\)\n\nשימו לב לבצע את הנרמול עבור כל קבוצה בנפרד."
  },
  {
    "objectID": "questions/6-implementing-formulas/index.html#יצירת-הטבלה",
    "href": "questions/6-implementing-formulas/index.html#יצירת-הטבלה",
    "title": "יישום נוסחאות בקוד",
    "section": "יצירת הטבלה",
    "text": "יצירת הטבלה\n\nDROP TABLE IF EXISTS ITEMS_Q6;\n\n\nCREATE TABLE items_q6\n    ([category] varchar(6), [amount] int)\n;\n    \nINSERT INTO items_q6\n    ([category], [amount])\nVALUES\n    ('Chairs', 12),\n    ('Chairs', 10),\n    ('Chairs', 10),\n    ('Chairs', 44),\n    ('Chairs', 93),\n    ('Chairs', 93),\n    ('Chairs', 32),\n    ('Chairs', 99),\n    ('Chairs', 95),\n    ('Chairs', 98),\n    ('Chairs', 85),\n    ('Chairs', 1),\n    ('Chairs', 39),\n    ('Chairs', 95),\n    ('Chairs', 91),\n    ('Chairs', 15),\n    ('Chairs', 38),\n    ('Chairs', 47),\n    ('Chairs', 31),\n    ('Chairs', 20),\n    ('Tables', 80),\n    ('Tables', 602),\n    ('Tables', 913),\n    ('Tables', 694),\n    ('Tables', 241),\n    ('Tables', 981),\n    ('Tables', 477),\n    ('Tables', 187),\n    ('Tables', 111),\n    ('Tables', 603),\n    ('Tables', 73),\n    ('Tables', 47),\n    ('Tables', 74),\n    ('Tables', 37),\n    ('Tables', 691),\n    ('Tables', 93),\n    ('Tables', 487),\n    ('Tables', 873),\n    ('Tables', 775),\n    ('Tables', 4),\n    ('Sofas', 146),\n    ('Sofas', 431),\n    ('Sofas', 330),\n    ('Sofas', 161),\n    ('Sofas', 308),\n    ('Sofas', 437),\n    ('Sofas', 97),\n    ('Sofas', 55),\n    ('Sofas', 383),\n    ('Sofas', 422),\n    ('Sofas', 127),\n    ('Sofas', 331),\n    ('Sofas', 213),\n    ('Sofas', 29),\n    ('Sofas', 260),\n    ('Sofas', 244),\n    ('Sofas', 398),\n    ('Sofas', 497),\n    ('Sofas', 276),\n    ('Sofas', 397),\n    ('Plates', 50),\n    ('Plates', 6),\n    ('Plates', 16),\n    ('Plates', 29),\n    ('Plates', 2),\n    ('Plates', 6),\n    ('Plates', 9),\n    ('Plates', 20),\n    ('Plates', 3),\n    ('Plates', 48),\n    ('Plates', 23),\n    ('Plates', 27),\n    ('Plates', 46),\n    ('Plates', 18),\n    ('Plates', 5),\n    ('Plates', 12),\n    ('Plates', 9),\n    ('Plates', 15),\n    ('Plates', 12),\n    ('Plates', 14),\n    ('Cups', 2),\n    ('Cups', 10),\n    ('Cups', 6),\n    ('Cups', 4),\n    ('Cups', 2),\n    ('Cups', 4),\n    ('Cups', 4),\n    ('Cups', 5),\n    ('Cups', 10),\n    ('Cups', 4),\n    ('Cups', 3),\n    ('Cups', 6),\n    ('Cups', 4),\n    ('Cups', 6),\n    ('Cups', 2),\n    ('Cups', 4),\n    ('Cups', 2),\n    ('Cups', 9),\n    ('Cups', 7),\n    ('Cups', 1)\n;"
  },
  {
    "objectID": "questions/6-implementing-formulas/index.html#תשובות",
    "href": "questions/6-implementing-formulas/index.html#תשובות",
    "title": "יישום נוסחאות בקוד",
    "section": "תשובות",
    "text": "תשובות\n\nסרטון הסבר\n\n\n\nתשובה 1\n\n\nהצג פתרון\n\nשימו לב כי הפתרון מותאם ל-T-SQL ולא יעבוד כמו שהוא בתיבת SQL למעלה.\n\nSELECT category,\n    STDEV(AMOUNT) / AVG(AMOUNT) AS CV\nFROM items_q6\nGROUP BY CATEGORY\nORDER BY CV;\n\n\n\n\n\n5 records\n\n\ncategory\nCV\n\n\n\n\nSofas\n0.5020680\n\n\nCups\n0.6633002\n\n\nChairs\n0.7032536\n\n\nPlates\n0.8195745\n\n\nTables\n0.8481626\n\n\n\n\n\n\n\nתשובה 2\n\n\nהצג פתרון\n\n\nSELECT category,\n    amount,\n    amount_noramlized = (AMOUNT - MIN(AMOUNT) OVER (PARTITION BY category)) * 100.0 / \n                        (MAX(AMOUNT) OVER (PARTITION BY category) - MIN(AMOUNT) OVER (PARTITION BY category))\nFROM items_q6\norder by category, amount_noramlized\n\n\n\n\n\nDisplaying records 1 - 10\n\n\ncategory\namount\namount_noramlized\n\n\n\n\nChairs\n1\n0.000000\n\n\nChairs\n10\n9.183673\n\n\nChairs\n10\n9.183673\n\n\nChairs\n12\n11.224490\n\n\nChairs\n15\n14.285714\n\n\nChairs\n20\n19.387755\n\n\nChairs\n31\n30.612245\n\n\nChairs\n32\n31.632653\n\n\nChairs\n38\n37.755102\n\n\nChairs\n39\n38.775510"
  },
  {
    "objectID": "questions/1-consecutive-actions/index.html#נסו-בעצמכם",
    "href": "questions/1-consecutive-actions/index.html#נסו-בעצמכם",
    "title": "זיהוי רצפים בהתחברות",
    "section": "נסו בעצמכם",
    "text": "נסו בעצמכם\n\nאונליין\nנסו בחלון טקסט למטה (SQLite):\n\n-- EDIT THIS QUERY:\nSELECT *\nfrom logins\nLIMIT 10;\n\n\n\nנסו על המחשב שלכם\n\n\nהצג קוד ליצירת טבלה\n\nמוזמנים להשתמש בקוד הבא ליצירת טבלה במחשב האישי שלכם (יש סימן להעתקה בצד ימין למעלה של המלבן כשמעבירים את העכבר מעליו):\n\n\n--drop table if exists logins; /* Drop with caution */\n\ncreate table logins (\n    user_id INT,\n    login_date DATE,\n    login VARCHAR(50)\n);\ninsert into logins (user_id, login_date, login) values (3, '8/12/2022', 'success');\ninsert into logins (user_id, login_date, login) values (4, '8/26/2022', 'success');\ninsert into logins (user_id, login_date, login) values (5, '7/17/2022', 'success');\ninsert into logins (user_id, login_date, login) values (5, '11/2/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '6/7/2023', 'success');\ninsert into logins (user_id, login_date, login) values (1, '5/7/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '4/28/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '4/26/2023', 'success');\ninsert into logins (user_id, login_date, login) values (2, '2/5/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '12/22/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '4/22/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/29/2023', 'success');\ninsert into logins (user_id, login_date, login) values (3, '4/19/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '4/6/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '4/16/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '5/22/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '3/10/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/23/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '1/18/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '4/27/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '11/6/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '11/18/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '9/17/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '11/14/2022', 'success');\ninsert into logins (user_id, login_date, login) values (3, '7/23/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '9/13/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '7/3/2022', 'success');\ninsert into logins (user_id, login_date, login) values (1, '12/9/2022', 'success');\ninsert into logins (user_id, login_date, login) values (4, '4/3/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '10/11/2022', 'success');\ninsert into logins (user_id, login_date, login) values (4, '3/16/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '1/10/2023', 'success');\ninsert into logins (user_id, login_date, login) values (3, '12/3/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '7/2/2022', 'success');\ninsert into logins (user_id, login_date, login) values (1, '10/11/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '2/24/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '9/11/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '4/11/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/3/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '1/30/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '10/21/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '7/9/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '8/12/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '5/30/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '8/11/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '10/22/2022', 'success');\ninsert into logins (user_id, login_date, login) values (3, '1/6/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '11/10/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '4/2/2023', 'success');\ninsert into logins (user_id, login_date, login) values (2, '7/17/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '8/6/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '1/11/2023', 'success');\ninsert into logins (user_id, login_date, login) values (2, '2/20/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '1/9/2023', 'success');\ninsert into logins (user_id, login_date, login) values (3, '1/3/2023', 'success');\ninsert into logins (user_id, login_date, login) values (2, '4/17/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '3/7/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/26/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '6/30/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '2/1/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '3/26/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '11/13/2022', 'success');\ninsert into logins (user_id, login_date, login) values (5, '8/11/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '1/30/2023', 'success');\ninsert into logins (user_id, login_date, login) values (3, '12/2/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '9/27/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '10/26/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '2/23/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '12/25/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '8/22/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '5/27/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '8/17/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '10/2/2022', 'success');\ninsert into logins (user_id, login_date, login) values (1, '7/15/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '2/6/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/5/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (1, '8/15/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '8/3/2022', 'success');\ninsert into logins (user_id, login_date, login) values (4, '12/17/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '9/11/2022', 'success');\ninsert into logins (user_id, login_date, login) values (5, '7/6/2022', 'success');\ninsert into logins (user_id, login_date, login) values (5, '1/14/2023', 'success');\ninsert into logins (user_id, login_date, login) values (1, '11/4/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '11/18/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '12/17/2022', 'success');\ninsert into logins (user_id, login_date, login) values (4, '5/2/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '8/14/2022', 'success');\ninsert into logins (user_id, login_date, login) values (1, '7/20/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '10/27/2022', 'success');\ninsert into logins (user_id, login_date, login) values (2, '2/24/2023', 'success');\ninsert into logins (user_id, login_date, login) values (5, '9/17/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '10/5/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (5, '1/12/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '4/30/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/14/2023', 'success');\ninsert into logins (user_id, login_date, login) values (2, '10/5/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (3, '7/24/2022', 'fail');\ninsert into logins (user_id, login_date, login) values (4, '6/3/2023', 'fail');\ninsert into logins (user_id, login_date, login) values (2, '11/27/2022', 'success');\ninsert into logins (user_id, login_date, login) values (1, '3/15/2023', 'success');\n\n\nבהצלחה!"
  },
  {
    "objectID": "questions/2-identical-different-payments/index.html#נסו-בעצמכם",
    "href": "questions/2-identical-different-payments/index.html#נסו-בעצמכם",
    "title": "אפיון תשלומים זהים או שונים",
    "section": "נסו בעצמכם",
    "text": "נסו בעצמכם\n\nאונליין\nנסו בחלון טקסט למטה (SQLite):\n\n-- EDIT THIS QUERY:\nSELECT *\nFROM payments_ag_2\nLIMIT 10;\n\n\n\nנסו על המחשב שלכם\n\n\nהצג קוד ליצירת טבלה\n\n\nDROP table if exists payments_ag_2;\n\n\nCREATE TABLE payments_ag_2\n    ([user_id] int, [date] date, [status] varchar(7), [amount] int)\n;\n    \nINSERT INTO payments_ag_2\n    ([user_id], [date], [status], [amount])\nVALUES\n    (1, '2023-06-01', 'Load', 234),\n    (1, '2023-06-14', 'Cancel', 42),\n    (1, '2023-06-16', 'Load', 52),\n    (1, '2023-06-22', 'Load', 6),\n    (1, '2023-06-23', 'Load', 36),\n    (1, '2023-06-24', 'Pending', 74),\n    (2, '2023-06-03', 'Load', 58),\n    (2, '2023-06-05', 'Load', 33),\n    (2, '2023-06-09', 'Load', 65),\n    (2, '2023-06-10', 'Load', 74),\n    (2, '2023-06-14', 'Load', 98),\n    (2, '2023-06-18', 'Load', 14),\n    (3, '2023-06-01', 'Cancel', 52),\n    (3, '2023-06-04', 'Cancel', 5),\n    (3, '2023-06-07', 'Pending', 99),\n    (4, '2023-06-09', 'Load', 100),\n    (4, '2023-06-10', 'Cancel', 15),\n    (5, '2023-06-15', 'Load', 20),\n    (6, '2023-06-16', 'Pending', 21),\n    (6, '2023-06-16', 'Load', 42)\n;"
  },
  {
    "objectID": "questions/3-ranking-without-window-function/index.html#נסו-בעצמכם",
    "href": "questions/3-ranking-without-window-function/index.html#נסו-בעצמכם",
    "title": "דירוג שורות בלי פונקצית חלון",
    "section": "נסו בעצמכם",
    "text": "נסו בעצמכם\n\nאונליין\nנסו בחלון טקסט למטה (SQLite):\n\n-- EDIT THIS QUERY:\nSELECT *\nFROM sales_ag\nLIMIT 10;\n\n\n\nנסו על המחשב שלכם\n\n\nהצג קוד ליצירת טבלה\n\n\nDROP TABLE IF EXISTS Sales_ag;\n\nCREATE TABLE sales_ag (\n    year INT,\n    category varchar(15),\n    amount INT\n)\n\n\nINSERT into Sales_ag (year, category, amount) values (2000, 'Automotive', 89);\ninsert into Sales_ag (year, category, amount) values (2000, 'Computers', 59);\ninsert into Sales_ag (year, category, amount) values (2000, 'Books', 19);\ninsert into Sales_ag (year, category, amount) values (2000, 'Movies', 74);\ninsert into Sales_ag (year, category, amount) values (2000, 'Garden', 74);\ninsert into Sales_ag (year, category, amount) values (2001, 'Clothing', 49);\ninsert into Sales_ag (year, category, amount) values (2001, 'Computers', 53);\ninsert into Sales_ag (year, category, amount) values (2001, 'Automotive', 65);\ninsert into Sales_ag (year, category, amount) values (2001, 'Garden', 24);\ninsert into Sales_ag (year, category, amount) values (2001, 'Movies', 39);"
  },
  {
    "objectID": "questions/4-before-and-after/index.html#נסו-בעצמכם",
    "href": "questions/4-before-and-after/index.html#נסו-בעצמכם",
    "title": "ערכים לפני ואחרי נקודת זמן",
    "section": "נסו בעצמכם",
    "text": "נסו בעצמכם\n\nאונליין\nנסו בחלון טקסט למטה (SQLite):\n\n-- EDIT THIS QUERY:\n--SELECT *\n--FROM churn_scores_ag_4\n--LIMIT 10;\n\nSELECT *\nFROM payments_ag_4\nLIMIT 10;\n\n\n\nנסו על המחשב שלכם\n\n\nהצג קוד ליצירת טבלה\n\n\nתשלומים\n\n\ncreate table payments_ag_4 (\n    user_id INT,\n    payment_date DATE,\n    amount DECIMAL(4,1)\n);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (4, '11/26/2022', 89.7);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (5, '11/29/2022', 57.5);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (4, '10/14/2022', 52.6);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (5, '12/3/2022', 18.3);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '10/14/2022', 73.9);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (5, '11/30/2022', 4.2);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (1, '11/13/2022', 4.0);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '11/9/2022', 97.3);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (3, '10/22/2022', 4.6);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (4, '10/16/2022', 42.0);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (4, '12/6/2022', 89.6);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (5, '11/29/2022', 36.9);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (5, '10/19/2022', 62.5);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (1, '11/10/2022', 61.8);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '10/31/2022', 17.5);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '11/10/2022', 5.7);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (1, '10/13/2022', 71.7);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '11/2/2022', 35.8);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (4, '11/21/2022', 52.3);\ninsert into payments_ag_4 (user_id, payment_date, amount) values (2, '10/19/2022', 31.2);\n\n\n\nציון סכנת נטישה\n\n\ndrop table if exists churn_scores_ag_4;\n\ncreate table churn_scores_ag_4 (\n    user_id INT,\n    score_date DATE,\n    churn_score INT\n);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '4/3/2023', 11);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '1/1/2023', 97);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '11/17/2022', 91);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '4/23/2023', 84);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '12/9/2022', 92);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/22/2023', 7);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '4/27/2023', 19);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '9/1/2022', 42);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '11/26/2022', 69);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '12/16/2022', 38);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '3/27/2023', 22);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '3/21/2023', 32);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '2/2/2023', 55);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/26/2023', 57);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/3/2023', 24);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '4/22/2023', 98);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '10/13/2022', 38);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '11/23/2022', 77);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '10/6/2022', 31);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '8/31/2022', 92);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '12/21/2022', 97);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '10/22/2022', 49);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '1/3/2023', 60);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '3/29/2023', 93);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '1/9/2023', 81);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '10/25/2022', 72);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '3/9/2023', 97);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '3/19/2023', 91);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/28/2023', 9);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/19/2023', 2);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '3/23/2023', 29);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '11/13/2022', 80);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '3/18/2023', 24);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '3/31/2023', 34);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '1/4/2023', 68);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '2/3/2023', 10);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '11/2/2022', 40);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/26/2023', 37);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '11/30/2022', 59);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '8/8/2022', 64);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '8/4/2022', 9);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '8/3/2022', 39);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '1/28/2023', 83);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '8/27/2022', 49);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '12/28/2022', 3);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '3/15/2023', 73);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '4/30/2023', 57);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '1/21/2023', 36);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '9/11/2022', 29);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '8/15/2022', 4);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '3/6/2023', 78);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '10/22/2022', 58);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '11/3/2022', 14);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '8/1/2022', 70);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '10/27/2022', 42);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '3/6/2023', 19);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '8/4/2022', 100);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '2/21/2023', 15);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '9/10/2022', 31);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '1/2/2023', 44);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '8/18/2022', 35);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '10/22/2022', 4);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '3/21/2023', 29);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '8/15/2022', 79);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '2/25/2023', 44);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '1/21/2023', 87);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '1/14/2023', 81);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '10/24/2022', 99);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '12/7/2022', 54);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '3/13/2023', 39);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '9/9/2022', 10);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '11/1/2022', 23);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '2/28/2023', 88);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '3/29/2023', 85);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '12/3/2022', 8);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '1/22/2023', 24);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '3/19/2023', 6);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '9/30/2022', 89);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '2/5/2023', 33);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '4/15/2023', 59);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '1/13/2023', 59);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '3/16/2023', 63);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '8/26/2022', 89);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '12/31/2022', 70);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '12/21/2022', 100);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '4/27/2023', 91);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '8/29/2022', 100);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '9/11/2022', 99);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '9/27/2022', 4);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (1, '12/5/2022', 36);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '9/24/2022', 18);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '9/19/2022', 68);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '12/7/2022', 72);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '12/25/2022', 72);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '1/6/2023', 8);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (5, '9/14/2022', 6);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '2/1/2023', 11);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (4, '9/14/2022', 10);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (2, '3/27/2023', 82);\ninsert into churn_scores_ag_4 (user_id, score_date, churn_score) values (3, '11/27/2022', 90);"
  },
  {
    "objectID": "questions/5-extract-text-from-logs/index.html#נסו-בעצמכם",
    "href": "questions/5-extract-text-from-logs/index.html#נסו-בעצמכם",
    "title": "חילוץ טקסט",
    "section": "נסו בעצמכם",
    "text": "נסו בעצמכם\n\nאונליין\nנסו בחלון טקסט למטה (SQLite):\n\n-- EDIT THIS QUERY:\nSELECT *\nFROM LOGS_Q5\nLIMIT 10;\n\n\n\nנסו על המחשב שלכם\n\n\nהצג קוד ליצירת טבלה\n\n\n\nDROP TABLE IF EXISTS LOGS_Q5;\n\nCREATE TABLE LOGS_Q5\n    (user_id int, log_date datetime, log_text varchar(128))\n;\n    \nINSERT INTO LOGS_Q5\n    (user_id, log_date, log_text)\nVALUES\n    (1, '2023-09-20 00:00:00', 'user 1 registered in 2018. Closure reason: Duplicate account.'),\n    (2, '2023-04-01 00:00:00', 'user 2 registered in 2022. Closure reason: Fraudulent behaviour.'),\n    (3, '2023-06-26 00:00:00', 'user 3 registered in 2016. Closure reason: Unsupported activity. Current status: open. Account has been re-opened'),\n    (4, '2023-06-21 00:00:00', 'user 4 registered in 2016. Closure reason: Did not provide relevant documents. Current status: open. Account has been re-opened'),\n    (5, '2023-02-04 00:00:00', 'user 5 registered in 2017. Closure reason: Unsupported activity.'),\n    (6, '2023-03-09 00:00:00', 'user 6 registered in 2022. Closure reason: Fraudulent behaviour. Current status: open. Account has been re-opened'),\n    (7, '2023-01-17 00:00:00', 'user 7 registered in 2018. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (8, '2023-09-12 00:00:00', 'user 8 registered in 2019. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (9, '2023-01-17 00:00:00', 'user 9 registered in 2014. Closure reason: Duplicate account. Current status: account closed.'),\n    (10, '2023-09-17 00:00:00', 'user 10 registered in 2018. Closure reason: Requested to close. Current status: account closed.'),\n    (11, '2023-01-06 00:00:00', 'user 11 registered in 2014. Closure reason: Unsupported activity. Current status: open. Account has been re-opened'),\n    (12, '2023-05-28 00:00:00', 'user 12 registered in 2015. Closure reason: Requested to close.'),\n    (13, '2023-09-09 00:00:00', 'user 13 registered in 2015. Closure reason: Fraudulent behaviour.'),\n    (14, '2023-04-08 00:00:00', 'user 14 registered in 2015. Closure reason: Duplicate account. Current status: open.'),\n    (15, '2023-03-19 00:00:00', 'user 15 registered in 2018. Closure reason: Duplicate account.'),\n    (16, '2023-10-09 00:00:00', 'user 16 registered in 2022. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (17, '2023-05-19 00:00:00', 'user 17 registered in 2015. Closure reason: Fraudulent behaviour. Current status: open. Account has been re-opened'),\n    (18, '2023-01-22 00:00:00', 'user 18 registered in 2016. Closure reason: Unsupported activity. Current status: account closed.'),\n    (19, '2023-08-30 00:00:00', 'user 19 registered in 2022. Closure reason: Fraudulent behaviour.'),\n    (20, '2023-09-26 00:00:00', 'user 20 registered in 2016. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (21, '2023-04-20 00:00:00', 'user 21 registered in 2015. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (22, '2023-05-02 00:00:00', 'user 22 registered in 2020. Closure reason: Duplicate account. Current status: account closed.'),\n    (23, '2023-04-18 00:00:00', 'user 23 registered in 2021. Closure reason: Duplicate account. Current status: account closed.'),\n    (24, '2023-07-27 00:00:00', 'user 24 registered in 2020. Closure reason: Requested to close.'),\n    (25, '2023-08-25 00:00:00', 'user 25 registered in 2020. Closure reason: Requested to close. Current status: open. Account has been re-opened'),\n    (26, '2023-07-22 00:00:00', 'user 26 registered in 2022. Closure reason: Fraudulent behaviour.'),\n    (27, '2023-01-28 00:00:00', 'user 27 registered in 2016. Closure reason: Unsupported activity. Current status: open.'),\n    (28, '2023-05-20 00:00:00', 'user 28 registered in 2017. Closure reason: Requested to close. Current status: open.'),\n    (29, '2023-09-10 00:00:00', 'user 29 registered in 2017. Closure reason: Unsupported activity.'),\n    (30, '2023-05-28 00:00:00', 'user 30 registered in 2019. Closure reason: Did not provide relevant documents. Current status: open. Account has been re-opened'),\n    (31, '2023-08-27 00:00:00', 'user 31 registered in 2018. Closure reason: Requested to close. Current status: account closed.'),\n    (32, '2023-01-08 00:00:00', 'user 32 registered in 2014. Closure reason: Fraudulent behaviour.'),\n    (33, '2023-07-20 00:00:00', 'user 33 registered in 2021. Closure reason: Unsupported activity. Current status: account closed.'),\n    (34, '2023-01-31 00:00:00', 'user 34 registered in 2016. Closure reason: Duplicate account. Current status: open.'),\n    (35, '2023-07-08 00:00:00', 'user 35 registered in 2019. Closure reason: Unsupported activity.'),\n    (36, '2023-07-31 00:00:00', 'user 36 registered in 2016. Closure reason: Requested to close. Current status: account closed.'),\n    (37, '2023-02-02 00:00:00', 'user 37 registered in 2019. Closure reason: Did not provide relevant documents. Current status: open.'),\n    (38, '2023-03-07 00:00:00', 'user 38 registered in 2016. Closure reason: Fraudulent behaviour.'),\n    (39, '2023-06-11 00:00:00', 'user 39 registered in 2017. Closure reason: Duplicate account. Current status: account closed.'),\n    (40, '2023-05-21 00:00:00', 'user 40 registered in 2014. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (41, '2023-08-12 00:00:00', 'user 41 registered in 2020. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (42, '2023-09-09 00:00:00', 'user 42 registered in 2018. Closure reason: Duplicate account.'),\n    (43, '2023-05-26 00:00:00', 'user 43 registered in 2014. Closure reason: Did not provide relevant documents.'),\n    (44, '2023-03-06 00:00:00', 'user 44 registered in 2016. Closure reason: Duplicate account. Current status: account closed.'),\n    (45, '2023-08-07 00:00:00', 'user 45 registered in 2016. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (46, '2023-10-04 00:00:00', 'user 46 registered in 2017. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (47, '2023-01-28 00:00:00', 'user 47 registered in 2019. Closure reason: Fraudulent behaviour. Current status: open. Account has been re-opened'),\n    (48, '2023-01-17 00:00:00', 'user 48 registered in 2021. Closure reason: Did not provide relevant documents. Current status: open. Account has been re-opened'),\n    (49, '2023-02-26 00:00:00', 'user 49 registered in 2015. Closure reason: Unsupported activity. Current status: account closed.'),\n    (50, '2023-06-19 00:00:00', 'user 50 registered in 2015. Closure reason: Duplicate account.'),\n    (51, '2023-01-13 00:00:00', 'user 51 registered in 2015. Closure reason: Duplicate account. Current status: open.'),\n    (52, '2023-03-02 00:00:00', 'user 52 registered in 2017. Closure reason: Did not provide relevant documents.'),\n    (53, '2023-01-14 00:00:00', 'user 53 registered in 2014. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (54, '2023-09-13 00:00:00', 'user 54 registered in 2018. Closure reason: Requested to close. Current status: open.'),\n    (55, '2023-07-17 00:00:00', 'user 55 registered in 2017. Closure reason: Requested to close. Current status: open. Account has been re-opened'),\n    (56, '2023-10-12 00:00:00', 'user 56 registered in 2018. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (57, '2023-09-27 00:00:00', 'user 57 registered in 2016. Closure reason: Duplicate account. Current status: open.'),\n    (58, '2023-02-15 00:00:00', 'user 58 registered in 2017. Closure reason: Did not provide relevant documents. Current status: open.'),\n    (59, '2023-10-26 00:00:00', 'user 59 registered in 2021. Closure reason: Duplicate account. Current status: account closed.'),\n    (60, '2023-07-10 00:00:00', 'user 60 registered in 2020. Closure reason: Unsupported activity. Current status: open.'),\n    (61, '2023-09-09 00:00:00', 'user 61 registered in 2020. Closure reason: Fraudulent behaviour.'),\n    (62, '2023-07-12 00:00:00', 'user 62 registered in 2017. Closure reason: Fraudulent behaviour.'),\n    (63, '2023-01-11 00:00:00', 'user 63 registered in 2017. Closure reason: Duplicate account. Current status: open.'),\n    (64, '2023-02-27 00:00:00', 'user 64 registered in 2020. Closure reason: Unsupported activity. Current status: open.'),\n    (65, '2023-07-12 00:00:00', 'user 65 registered in 2021. Closure reason: Did not provide relevant documents.'),\n    (66, '2023-03-09 00:00:00', 'user 66 registered in 2014. Closure reason: Requested to close. Current status: open. Account has been re-opened'),\n    (67, '2023-10-31 00:00:00', 'user 67 registered in 2022. Closure reason: Duplicate account.'),\n    (68, '2023-06-26 00:00:00', 'user 68 registered in 2018. Closure reason: Duplicate account. Current status: open.'),\n    (69, '2023-04-22 00:00:00', 'user 69 registered in 2022. Closure reason: Did not provide relevant documents. Current status: open.'),\n    (70, '2023-09-22 00:00:00', 'user 70 registered in 2015. Closure reason: Unsupported activity.'),\n    (71, '2023-10-04 00:00:00', 'user 71 registered in 2016. Closure reason: Duplicate account. Current status: open.'),\n    (72, '2023-10-31 00:00:00', 'user 72 registered in 2020. Closure reason: Unsupported activity.'),\n    (73, '2023-04-20 00:00:00', 'user 73 registered in 2020. Closure reason: Did not provide relevant documents. Current status: open.'),\n    (74, '2023-10-15 00:00:00', 'user 74 registered in 2017. Closure reason: Duplicate account. Current status: account closed.'),\n    (75, '2023-07-23 00:00:00', 'user 75 registered in 2021. Closure reason: Fraudulent behaviour.'),\n    (76, '2023-03-15 00:00:00', 'user 76 registered in 2017. Closure reason: Duplicate account.'),\n    (77, '2023-10-27 00:00:00', 'user 77 registered in 2019. Closure reason: Requested to close. Current status: account closed.'),\n    (78, '2023-02-03 00:00:00', 'user 78 registered in 2022. Closure reason: Requested to close. Current status: account closed.'),\n    (79, '2023-08-09 00:00:00', 'user 79 registered in 2019. Closure reason: Duplicate account.'),\n    (80, '2023-05-19 00:00:00', 'user 80 registered in 2021. Closure reason: Requested to close.'),\n    (81, '2023-01-02 00:00:00', 'user 81 registered in 2020. Closure reason: Duplicate account. Current status: open. Account has been re-opened'),\n    (82, '2023-08-08 00:00:00', 'user 82 registered in 2020. Closure reason: Duplicate account. Current status: open. Account has been re-opened'),\n    (83, '2023-04-25 00:00:00', 'user 83 registered in 2021. Closure reason: Duplicate account.'),\n    (84, '2023-04-24 00:00:00', 'user 84 registered in 2020. Closure reason: Duplicate account.'),\n    (85, '2023-01-15 00:00:00', 'user 85 registered in 2021. Closure reason: Fraudulent behaviour.'),\n    (86, '2023-01-11 00:00:00', 'user 86 registered in 2020. Closure reason: Duplicate account. Current status: account closed.'),\n    (87, '2023-08-08 00:00:00', 'user 87 registered in 2021. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (88, '2023-01-27 00:00:00', 'user 88 registered in 2015. Closure reason: Unsupported activity.'),\n    (89, '2023-08-31 00:00:00', 'user 89 registered in 2020. Closure reason: Unsupported activity. Current status: account closed.'),\n    (90, '2023-07-26 00:00:00', 'user 90 registered in 2021. Closure reason: Duplicate account. Current status: account closed.'),\n    (91, '2023-07-10 00:00:00', 'user 91 registered in 2014. Closure reason: Unsupported activity. Current status: account closed.'),\n    (92, '2023-07-18 00:00:00', 'user 92 registered in 2017. Closure reason: Fraudulent behaviour. Current status: account closed.'),\n    (93, '2023-08-19 00:00:00', 'user 93 registered in 2021. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (94, '2023-01-26 00:00:00', 'user 94 registered in 2015. Closure reason: Duplicate account.'),\n    (95, '2023-08-14 00:00:00', 'user 95 registered in 2019. Closure reason: Did not provide relevant documents. Current status: account closed.'),\n    (96, '2023-05-11 00:00:00', 'user 96 registered in 2022. Closure reason: Fraudulent behaviour.'),\n    (97, '2023-08-03 00:00:00', 'user 97 registered in 2020. Closure reason: Duplicate account. Current status: open. Account has been re-opened'),\n    (98, '2023-01-17 00:00:00', 'user 98 registered in 2017. Closure reason: Unsupported activity. Current status: open.'),\n    (99, '2023-10-08 00:00:00', 'user 99 registered in 2021. Closure reason: Did not provide relevant documents.'),\n    (100, '2023-10-18 00:00:00', 'user 100 registered in 2019. Closure reason: Duplicate account. Current status: open. Account has been re-opened')\n;"
  },
  {
    "objectID": "questions/6-implementing-formulas/index.html#נסו-בעצמכם",
    "href": "questions/6-implementing-formulas/index.html#נסו-בעצמכם",
    "title": "יישום נוסחאות בקוד",
    "section": "נסו בעצמכם",
    "text": "נסו בעצמכם\n\nאונליין\nנסו בחלון טקסט למטה (SQLite):\n\n-- EDIT THIS QUERY:\nSELECT *\nFROM Items_q6\nLIMIT 10;\n\n\n\nנסו על המחשב שלכם\n\n\nהצג קוד ליצירת טבלה\n\n\nDROP TABLE IF EXISTS ITEMS_Q6;\n\n\nCREATE TABLE items_q6\n    ([category] varchar(6), [amount] int)\n;\n    \nINSERT INTO items_q6\n    ([category], [amount])\nVALUES\n    ('Chairs', 12),\n    ('Chairs', 10),\n    ('Chairs', 10),\n    ('Chairs', 44),\n    ('Chairs', 93),\n    ('Chairs', 93),\n    ('Chairs', 32),\n    ('Chairs', 99),\n    ('Chairs', 95),\n    ('Chairs', 98),\n    ('Chairs', 85),\n    ('Chairs', 1),\n    ('Chairs', 39),\n    ('Chairs', 95),\n    ('Chairs', 91),\n    ('Chairs', 15),\n    ('Chairs', 38),\n    ('Chairs', 47),\n    ('Chairs', 31),\n    ('Chairs', 20),\n    ('Tables', 80),\n    ('Tables', 602),\n    ('Tables', 913),\n    ('Tables', 694),\n    ('Tables', 241),\n    ('Tables', 981),\n    ('Tables', 477),\n    ('Tables', 187),\n    ('Tables', 111),\n    ('Tables', 603),\n    ('Tables', 73),\n    ('Tables', 47),\n    ('Tables', 74),\n    ('Tables', 37),\n    ('Tables', 691),\n    ('Tables', 93),\n    ('Tables', 487),\n    ('Tables', 873),\n    ('Tables', 775),\n    ('Tables', 4),\n    ('Sofas', 146),\n    ('Sofas', 431),\n    ('Sofas', 330),\n    ('Sofas', 161),\n    ('Sofas', 308),\n    ('Sofas', 437),\n    ('Sofas', 97),\n    ('Sofas', 55),\n    ('Sofas', 383),\n    ('Sofas', 422),\n    ('Sofas', 127),\n    ('Sofas', 331),\n    ('Sofas', 213),\n    ('Sofas', 29),\n    ('Sofas', 260),\n    ('Sofas', 244),\n    ('Sofas', 398),\n    ('Sofas', 497),\n    ('Sofas', 276),\n    ('Sofas', 397),\n    ('Plates', 50),\n    ('Plates', 6),\n    ('Plates', 16),\n    ('Plates', 29),\n    ('Plates', 2),\n    ('Plates', 6),\n    ('Plates', 9),\n    ('Plates', 20),\n    ('Plates', 3),\n    ('Plates', 48),\n    ('Plates', 23),\n    ('Plates', 27),\n    ('Plates', 46),\n    ('Plates', 18),\n    ('Plates', 5),\n    ('Plates', 12),\n    ('Plates', 9),\n    ('Plates', 15),\n    ('Plates', 12),\n    ('Plates', 14),\n    ('Cups', 2),\n    ('Cups', 10),\n    ('Cups', 6),\n    ('Cups', 4),\n    ('Cups', 2),\n    ('Cups', 4),\n    ('Cups', 4),\n    ('Cups', 5),\n    ('Cups', 10),\n    ('Cups', 4),\n    ('Cups', 3),\n    ('Cups', 6),\n    ('Cups', 4),\n    ('Cups', 6),\n    ('Cups', 2),\n    ('Cups', 4),\n    ('Cups', 2),\n    ('Cups', 9),\n    ('Cups', 7),\n    ('Cups', 1)\n;"
  }
]