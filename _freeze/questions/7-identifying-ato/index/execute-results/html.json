{
  "hash": "8de80f099923652e4dc71afb0bdbb572",
  "result": {
    "markdown": "---\ntitle: \"זיהוי השתלטות על חשבון\"\ndescription: |\n  מציאת חשבונות שפרצו להם לחשבון ומנסים לגנוב מהם כסף\nauthor: \"\"\ndate: \"2023-01-25\"\ntoc: true\ncategories: [בסיסי]\nimage: featured.png\ndraft: true\n---\n\n\n\n\nברוכים הבאים לתרגיל השביעי!\n\n## הדאטה\n\nהתרגיל מורכב מטבלת התחברויות וביצוע תשלומים של יוזרים:\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n--SELECT TOP 5 * \n--FROM Items_q7\n```\n:::\n\n\nעבור כל יוזר ניתן לראות את זמן ההתחברות שלו וה-GUID ממנו התחבר או ביצע את שליחת התשלום. לצורך התרגיל ה-GUID הוא מחרוזת שמייצגת שילוב של סוג המחשב ממנו היוזר התחבר, הדפדפן שהוא השתמש, IP ודברים נוספים. ניתן למצוא עוד מידע [כאן](https://www.techtarget.com/searchwindowsserver/definition/GUID-global-unique-identifier)\n\n## שאלה 1\n\nהצג את שכיחות בין כלל החשבונות. כלומר, לכמה משתמשים יש GUID אחד ייחודי, לכמה 2, לכמה 3 וכן הלאה-GUID הייחודיים \n\n## שאלה 2\n\nאחד הסימנים שנראה להשתלטות על חשבון הוא התחברות מ-GUID שלא נראה בימים שקודמים לשליחת התשלום. לצורך התרגיל, מיצאו את המשתמשים ששלחו תשלום מ-GUID שהופיע לראשונה עד שלושה ימים ממועד שליחת התשלום.\n\n#### דוגמא\n\nליוזר הבא יש את היסטורית ההתחברויות והתשלומים הבאה:\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n--SELECT TOP 5 * \n--FROM Items_q7\n```\n:::\n\n\n  ניתן לראות כי בתאריך XXX הוא שלח תשלום מ-GUID שלא נראה עד כה ולכן נרצה להחזירו בפלט.\n\n## יצירת הטבלה\n\n\n::: {.cell}\n\n```{.sql .cell-code style=\"max-height: 200px;overflow: scroll;\"}\nDROP TABLE IF EXISTS ITEMS_Q6;\n\n\nCREATE TABLE items_q6\n    ([category] varchar(6), [amount] int)\n;\n    \nINSERT INTO items_q6\n    ([category], [amount])\nVALUES\n    ('Chairs', 12),\n    ('Chairs', 10),\n    ('Chairs', 10),\n    ('Chairs', 44),\n    ('Chairs', 93),\n    ('Chairs', 93),\n    ('Chairs', 32),\n    ('Chairs', 99),\n    ('Chairs', 95),\n    ('Chairs', 98),\n    ('Chairs', 85),\n    ('Chairs', 1),\n    ('Chairs', 39),\n    ('Chairs', 95),\n    ('Chairs', 91),\n    ('Chairs', 15),\n    ('Chairs', 38),\n    ('Chairs', 47),\n    ('Chairs', 31),\n    ('Chairs', 20),\n    ('Tables', 80),\n    ('Tables', 602),\n    ('Tables', 913),\n    ('Tables', 694),\n    ('Tables', 241),\n    ('Tables', 981),\n    ('Tables', 477),\n    ('Tables', 187),\n    ('Tables', 111),\n    ('Tables', 603),\n    ('Tables', 73),\n    ('Tables', 47),\n    ('Tables', 74),\n    ('Tables', 37),\n    ('Tables', 691),\n    ('Tables', 93),\n    ('Tables', 487),\n    ('Tables', 873),\n    ('Tables', 775),\n    ('Tables', 4),\n    ('Sofas', 146),\n    ('Sofas', 431),\n    ('Sofas', 330),\n    ('Sofas', 161),\n    ('Sofas', 308),\n    ('Sofas', 437),\n    ('Sofas', 97),\n    ('Sofas', 55),\n    ('Sofas', 383),\n    ('Sofas', 422),\n    ('Sofas', 127),\n    ('Sofas', 331),\n    ('Sofas', 213),\n    ('Sofas', 29),\n    ('Sofas', 260),\n    ('Sofas', 244),\n    ('Sofas', 398),\n    ('Sofas', 497),\n    ('Sofas', 276),\n    ('Sofas', 397),\n    ('Plates', 50),\n    ('Plates', 6),\n    ('Plates', 16),\n    ('Plates', 29),\n    ('Plates', 2),\n    ('Plates', 6),\n    ('Plates', 9),\n    ('Plates', 20),\n    ('Plates', 3),\n    ('Plates', 48),\n    ('Plates', 23),\n    ('Plates', 27),\n    ('Plates', 46),\n    ('Plates', 18),\n    ('Plates', 5),\n    ('Plates', 12),\n    ('Plates', 9),\n    ('Plates', 15),\n    ('Plates', 12),\n    ('Plates', 14),\n    ('Cups', 2),\n    ('Cups', 10),\n    ('Cups', 6),\n    ('Cups', 4),\n    ('Cups', 2),\n    ('Cups', 4),\n    ('Cups', 4),\n    ('Cups', 5),\n    ('Cups', 10),\n    ('Cups', 4),\n    ('Cups', 3),\n    ('Cups', 6),\n    ('Cups', 4),\n    ('Cups', 6),\n    ('Cups', 2),\n    ('Cups', 4),\n    ('Cups', 2),\n    ('Cups', 9),\n    ('Cups', 7),\n    ('Cups', 1)\n;\n\n```\n:::\n\n\n## תשובות\n\n### סרטון הסבר\n\n\n\n{{< video https://youtu.be/E4y7uU8N-Ks >}}\n\n\n\n\n### תשובה 1\n\n<details>\n\n<summary>הצג פתרון</summary>\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT category,\n\tSTDEV(AMOUNT) / AVG(AMOUNT) AS CV\nFROM items_q6\nGROUP BY CATEGORY\nORDER BY CV;\n```\n:::\n\n\n</details>\n\n\n::: {.cell}\n<div class=\"knitsql-table\">\n\n\nTable: 5 records\n\n|category |        CV|\n|:--------|---------:|\n|Sofas    | 0.5020680|\n|Cups     | 0.6633002|\n|Chairs   | 0.7032536|\n|Plates   | 0.8195745|\n|Tables   | 0.8481626|\n\n</div>\n:::\n\n\n### תשובה 2\n\n<details>\n\n<summary>הצג פתרון</summary>\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT category,\n\tamount,\n\tamount_noramlized = (AMOUNT - MIN(AMOUNT) OVER (PARTITION BY category)) * 100.0 / \n\t\t\t\t\t\t(MAX(AMOUNT) OVER (PARTITION BY category) - MIN(AMOUNT) OVER (PARTITION BY category))\nFROM items_q6\norder by category, amount_noramlized\n\n```\n:::\n\n\n</details>\n\n\n::: {.cell}\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|category | amount| amount_noramlized|\n|:--------|------:|-----------------:|\n|Chairs   |      1|          0.000000|\n|Chairs   |     10|          9.183673|\n|Chairs   |     10|          9.183673|\n|Chairs   |     12|         11.224490|\n|Chairs   |     15|         14.285714|\n|Chairs   |     20|         19.387755|\n|Chairs   |     31|         30.612245|\n|Chairs   |     32|         31.632653|\n|Chairs   |     38|         37.755102|\n|Chairs   |     39|         38.775510|\n\n</div>\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}